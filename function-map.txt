alt-ppt4lecture 함수 설명 지도 (텍스트 버전)

목적
- 코드가 길어질수록 LLM 수정 실수가 늘어나므로, 함수 경계를 고정해 안전한 수정 지점을 만든다.
- 유지보수 시 "어디를 건드려야 하는지"를 빠르게 판단할 수 있게 한다.
- 단일 HTML 파일 유지 전제에서, 리팩토링의 기준 문서 역할을 한다.

대상 파일
- alt-ppt4lecture.html

총 함수 수
- 72개 (내부 함수 2개: onMouseMove / onMouseUp 포함)

리팩토링 추천 묶음(이름 + 이유 + 포함 함수)

1) StageController
- 이유: 화면 비율, 스케일, 전체화면이 서로 의존적이어서 한 덩어리로 관리하는 게 안전하다.
- 함수: updateStageDimensions, toggleAspectRatio, toggleDisplayMode, resizeStage, startPresentation, exitPresentation, handleFullscreenChange

2) SlideManager
- 이유: 슬라이드 조작은 UI와 데이터가 동시에 바뀌므로 묶어두면 실수가 줄어든다.
- 함수: refreshSlides, getActiveSlide, updateSlideVisibility, nextSlide, prevSlide, addNewSlide, collectSlideAssets,
        deleteCurrentSlide, requestDeleteSlide, deleteSlideAtIndex, removeGuideText

3) AssetRegistry
- 이유: 파일명/경로/중복 처리 실수는 치명적이므로 전용 묶음으로 안전하게 관리한다.
- 함수: sanitizeFileName, splitName, splitPath, sanitizePath, normalizeAssetPath, uniquePath, inferImageExtension,
        extractSrcsetPaths, extractRequiredAssetsFromHtml, registerRequiredAssetsFromHtml, matchRequiredAssetPath,
        registerImageAsset, registerSupportFile, getMissingAssets, removeImageAssetIfUnused, removeHtmlAssetIfUnused

4) PackageIO
- 이유: 저장/로드는 실패 시 데이터 손실 위험이 있어 가장 엄격하게 관리해야 한다.
- 함수: ensurePackageExtension, stripExtensionFromName, applyTitleToClone, parseDataUrl, decodeBase64ToUint8Array,
        convertEmbeddedImagesInDocument, convertBase64ImagesInHtml, triggerPackageLoad, guessMimeType, parseZipEntries,
        findMainHtml, loadPackageFromFile, crc32, toDosDateTime, toUint8Array, buildZip, savePackageAs, savePackage

5) ThumbnailView
- 이유: 썸네일 렌더는 성능 이슈가 생기기 쉬워 별도 관리가 안전하다.
- 함수: scheduleThumbnailRefresh, renderThumbnails, updateThumbnailActive

6) InteractionHub
- 이유: 입력 이벤트가 많아질수록 충돌이 생기므로 한 곳에서 통제해야 한다.
- 함수: bindEvents, handleDroppedFiles, transformCurrentSlideToHtml, createDraggableImageFromBlob, setupInteraction,
        selectImage, deselectImage, deleteSelectedImage, showSaveButton, getElementStyleNumber, captureImageState,
        copySelectedImage, createDraggableImageFromAsset, pasteClipboardImage

7) AppBoot
- 이유: 시작 시점의 동작을 하나로 묶으면 초기화 순서를 안정적으로 유지할 수 있다.
- 함수: init

함수 설명 (카테고리별)

[기초 상태]
- refreshSlides(): DOM에서 슬라이드 목록을 다시 읽어 state를 최신화한다.
- getActiveSlide(): 현재 활성 슬라이드를 가져온다.
- removeGuideText(slide): 빈 슬라이드 안내 문구를 제거한다.

[화면 비율과 스케일]
- updateStageDimensions(): 16:9 또는 4:3에 맞춰 스테이지 크기를 재설정한다.
- toggleAspectRatio(): 비율을 16:9/4:3로 전환한다.
- toggleDisplayMode(): 화면 맞춤(Fit)/채움(Stretch) 모드를 전환한다.
- resizeStage(): 화면 크기에 맞게 스테이지를 확대/축소한다.

[경로/파일 유틸]
- sanitizeFileName(name): 파일명에서 경로 및 금지 문자를 제거한다.
- splitName(name): 파일명을 이름/확장자로 분리한다.
- splitPath(path): 경로를 폴더/파일명/확장자로 분리한다.
- parseDataUrl(value): data URL을 MIME과 데이터로 분해한다.
- decodeBase64ToUint8Array(base64): base64 문자열을 바이트 배열로 변환한다.
- convertEmbeddedImagesInDocument(doc, cache): 문서의 data 이미지를 파일 에셋으로 분리한다.
- convertBase64ImagesInHtml(htmlText, cache): HTML 문자열의 data 이미지를 에셋으로 변환한다.
- stripExtensionFromName(name, extension): 파일명에서 확장자를 제거한다.
- applyTitleToClone(clone, titleText): 복제된 문서에 title을 넣는다.
- sanitizePath(path): 위험한 경로 요소를 제거한다.
- ensurePackageExtension(name): 파일명이 .altppt로 끝나게 보정한다.
- uniquePath(path): 중복을 피하는 안전한 파일명을 만든다.
- inferImageExtension(name, type): 이미지 확장자를 추정한다.
- normalizeAssetPath(value): 외부 URL을 제외한 안전한 상대경로만 추출한다.
- extractSrcsetPaths(srcsetValue, assets): srcset의 여러 경로를 추출한다.

[에셋 등록]
- extractRequiredAssetsFromHtml(htmlText): HTML에서 필요한 리소스 경로를 수집한다.
- registerRequiredAssetsFromHtml(htmlText): 필요한 에셋 목록을 상태에 등록한다.
- matchRequiredAssetPath(fileName): 파일명으로 필요한 에셋 경로를 추정한다.
- registerImageAsset(blob, preferredName): 이미지 파일을 assets/에 등록한다.
- registerSupportFile(file): 지원 파일을 패키지에 등록한다.
- getMissingAssets(): 필요한데 등록되지 않은 파일 목록을 찾는다.
- removeImageAssetIfUnused(assetPath): 더 이상 쓰지 않는 이미지를 제거한다.
- removeHtmlAssetIfUnused(fileName): 더 이상 쓰지 않는 HTML 파일을 제거한다.

[패키지 로드]
- triggerPackageLoad(): 파일 선택 창을 열어 패키지를 불러오게 한다.
- guessMimeType(name): 파일 확장자로 MIME 타입을 추정한다.
- parseZipEntries(buffer): ZIP 파일을 직접 파싱해 파일 목록을 만든다.
- findMainHtml(files): ZIP 안에서 메인 슬라이드 HTML을 찾는다.
- loadPackageFromFile(file): 패키지를 불러와 현재 작업을 교체한다.

[썸네일]
- scheduleThumbnailRefresh(): 썸네일 재렌더를 다음 프레임으로 미룬다.
- renderThumbnails(): 썸네일을 새로 그린다.
- updateThumbnailActive(): 현재 슬라이드 썸네일을 강조 표시한다.

[클립보드/요소 상태]
- getElementStyleNumber(element, prop, fallback): 스타일에서 숫자를 안전하게 추출한다.
- captureImageState(wrapper): 선택된 이미지의 위치/크기 정보를 저장한다.
- copySelectedImage(): 선택된 이미지를 내부 클립보드에 저장한다.
- createDraggableImageFromAsset(assetPath, layout): 에셋으로 새 이미지 요소를 만든다.
- pasteClipboardImage(): 클립보드 이미지 붙여넣기.

[초기화]
- init(): 이벤트 연결, 화면 맞춤, 썸네일 렌더를 한 번에 수행한다.

[슬라이드 관리]
- updateSlideVisibility(): 현재 슬라이드만 보이게 전환한다.
- nextSlide(): 다음 슬라이드로 이동한다.
- prevSlide(): 이전 슬라이드로 이동한다.
- addNewSlide(): 현재 슬라이드 뒤에 새 슬라이드를 추가한다.
- collectSlideAssets(slide): 슬라이드에 포함된 에셋을 모은다.
- deleteCurrentSlide(): 현재 슬라이드 삭제를 요청한다.
- requestDeleteSlide(index): 삭제 확인 메시지를 표시한다.
- deleteSlideAtIndex(index): 실제 슬라이드를 제거하고 상태를 정리한다.

[이벤트 바인딩]
- bindEvents(): 키보드/마우스/드래그/전체화면 이벤트를 모두 연결한다.

[드롭 및 HTML 처리]
- handleDroppedFiles(files, options): 드롭된 파일을 종류별로 처리한다.
- transformCurrentSlideToHtml(fileOrName): 현재 슬라이드를 iframe 기반 HTML로 변환한다.

[이미지 생성과 드래그]
- createDraggableImageFromBlob(blob, preferredName): 이미지 파일을 캔버스에 올린다.
- setupInteraction(element, handle): 요소에 드래그/리사이즈 동작을 붙인다.
- onMouseMove(): setupInteraction 내부에서 이동/리사이즈 계산을 담당한다. (내부 함수)
- onMouseUp(): setupInteraction 내부에서 종료 처리를 담당한다. (내부 함수)

[선택/삭제/저장 표시]
- selectImage(el): 요소를 선택 상태로 표시한다.
- deselectImage(): 선택을 해제한다.
- deleteSelectedImage(): 선택된 요소와 관련 에셋을 삭제한다.
- showSaveButton(): 저장 버튼 표시 + 썸네일 갱신 예약.

[저장 및 ZIP]
- crc32(data): ZIP 무결성 체크용 CRC32 계산.
- toDosDateTime(date): ZIP 헤더용 날짜/시간 변환.
- toUint8Array(data): 다양한 데이터를 바이트 배열로 변환.
- buildZip(entries): ZIP 바이너리 생성.
- savePackageAs(): 다른 이름으로 저장을 강제한다.
- savePackage(options): 전체 상태를 패키지로 저장한다.

[전체화면]
- startPresentation(): 전체화면 모드를 시작한다.
- exitPresentation(): 전체화면을 종료한다.
- handleFullscreenChange(): 전체화면 변경 시 스케일을 갱신한다.
