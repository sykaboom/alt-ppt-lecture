<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Presentation Tool (Fixed Ratio)</title>
    <!-- [ì¶”ê°€] ZIP íŒŒì¼ ìƒì„±ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        /* [ìŠ¤íƒ€ì¼] ê¸°ë³¸ ì„¤ì • */
        * { box-sizing: border-box; }
        body {
            margin: 0; padding: 0;
            background-color: #333; /* PPT í¸ì§‘ê¸°ì²˜ëŸ¼ ì–´ë‘ìš´ ë°°ê²½ */
            color: #333;
            font-family: 'Noto Sans KR', sans-serif;
            overflow: hidden; 
            user-select: none; 
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* [ìŠ¬ë¼ì´ë“œ ìŠ¤í…Œì´ì§€] - í•µì‹¬: ê³ ì • í•´ìƒë„ (1280x720) */
        /* í™”ë©´ í¬ê¸°ì— ë”°ë¼ transform: scale()ë¡œ ì¡°ì ˆë¨ */
        #slide-stage {
            width: 1280px;  /* ê¸°ì¤€ ë„ˆë¹„ */
            height: 720px; /* ê¸°ì¤€ ë†’ì´ (16:9) */
            background-color: white;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.5); /* ê·¸ë¦¼ì */
            transform-origin: center center; /* ì¤‘ì•™ ê¸°ì¤€ í™•ëŒ€/ì¶•ì†Œ */
            overflow: hidden; /* ìŠ¬ë¼ì´ë“œ ë°–ìœ¼ë¡œ ë‚˜ê°„ ë‚´ìš© ìˆ¨ê¹€ */
        }

        /* ë“œë˜ê·¸ ì•¤ ë“œë¡­ í™œì„±í™” ì‹œ íš¨ê³¼ (ìŠ¤í…Œì´ì§€ì— ì ìš©) */
        #slide-stage.drag-over {
            border: 5px dashed #2196f3;
            background-color: #f0f8ff;
        }

        /* [ìŠ¬ë¼ì´ë“œ] ê°œë³„ í˜ì´ì§€ */
        .slide {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: none;
        }
        .slide.active { display: block; }

        /* [ì´ë¯¸ì§€] ë“œë˜ê·¸ ë° ë¦¬ì‚¬ì´ì¦ˆ ê°€ëŠ¥ ìŠ¤íƒ€ì¼ */
        .draggable-img {
            position: absolute; 
            cursor: move; 
            border: 2px solid transparent; 
            min-width: 50px;
            min-height: 50px;
        }
        
        .draggable-img.selected {
            border: 2px solid #007bff; 
            z-index: 1000; 
        }

        .resize-handle {
            width: 15px; height: 15px;
            background: #007bff;
            position: absolute;
            right: -5px; bottom: -5px;
            cursor: se-resize; 
            display: none; 
            z-index: 1001;
        }
        .draggable-img.selected .resize-handle {
            display: block; 
        }

        /* [ì™¸ë¶€ HTML - iframe] ì°½ ì•ˆì˜ ì°½ ìŠ¤íƒ€ì¼ */
        /* ìŠ¬ë¼ì´ë“œ í¬ê¸°(1280x720) ê¸°ì¤€ìœ¼ë¡œ ë°°ì¹˜ */
        .iframe-container {
            width: 100%; 
            height: 100%;
            position: absolute;
            top: 0; left: 0;
            background: white;
        }

        iframe {
            width: 100%; height: 100%;
            border: none;
            display: block;
        }

        /* [í…ìŠ¤íŠ¸] ê°€ì´ë“œ ë¬¸êµ¬ */
        .guide-text {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #999;
            pointer-events: none; 
            width: 80%;
        }
        .guide-text h1 { font-size: 40px; margin-bottom: 20px; color: #555; }
        .guide-text p { font-size: 20px; line-height: 1.6; }

        /* [HTML ì•Œë¦¼ë°”] */
        .iframe-notice {
            position: absolute;
            top: 10px; left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            font-size: 14px;
            pointer-events: auto;
            z-index: 2000;
        }

        /* [UI] ìƒë‹¨ ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        #ui-controls {
            position: fixed;
            top: 20px; right: 20px;
            z-index: 9999;
            display: flex;
            gap: 10px;
            transition: opacity 0.3s;
        }
        button {
            padding: 10px 20px;
            background: #444;
            color: white;
            border: 1px solid #666;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        button:hover { background: #666; }
        #save-btn { background: #28a745; border-color: #28a745; display: none; } 
        #fs-btn { background: #007bff; border-color: #007bff; }

        /* [UI] í˜ì´ì§€ ë²ˆí˜¸ */
        #page-indicator {
            position: absolute;
            bottom: 20px; right: 20px;
            background: rgba(0,0,0,0.5);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            pointer-events: none;
            z-index: 9998;
            transition: opacity 0.3s;
        }

        /* [ë„¤ë¹„ê²Œì´ì…˜] ì–‘ìª½ ì˜ì—­ (í™”ë©´ ì „ì²´ ë†’ì´) */
        .nav-zone {
            position: fixed;
            top: 0;
            height: 100%;
            width: 80px; 
            z-index: 9000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0; 
            transition: opacity 0.3s ease;
            cursor: pointer;
            color: rgba(255,255,255,0.5);
            font-size: 60px;
            font-weight: bold;
        }
        
        .nav-zone:hover {
            opacity: 1;
            background: linear-gradient(to right, rgba(0,0,0,0.5), transparent);
        }
        #nav-next.nav-zone:hover {
            background: linear-gradient(to left, rgba(0,0,0,0.5), transparent);
        }
        
        #nav-prev { left: 0; }
        #nav-next { right: 0; }

        /* [ì „ì²´í™”ë©´ ëª¨ë“œ ìŠ¤íƒ€ì¼] */
        body.is-fullscreen #ui-controls,
        body.is-fullscreen #page-indicator,
        body.is-fullscreen .resize-handle,
        body.is-fullscreen .iframe-notice { display: none !important; }
        
        body.is-fullscreen .draggable-img.selected {
            border-color: transparent !important;
        }
        
        body.is-fullscreen .draggable-img {
            cursor: default !important; 
        }
        
        body.is-fullscreen {
            background-color: black; /* ë°œí‘œ ì‹œì—” ì™„ì „ ê²€ì • */
        }

    </style>
</head>
<body>

    <!-- ì–‘ìª½ ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
    <div id="nav-prev" class="nav-zone" onclick="prevSlide()">â®</div>
    <div id="nav-next" class="nav-zone" onclick="nextSlide()">â¯</div>

    <!-- ìƒë‹¨ UI ì»¨íŠ¸ë¡¤ -->
    <div id="ui-controls">
        <button id="fs-btn" onclick="startPresentation()">ğŸ–¥ï¸ ë°œí‘œ ì‹œì‘</button>
        <button onclick="addNewSlide()">+ ìƒˆ ìŠ¬ë¼ì´ë“œ</button>
        <button onclick="deleteSelectedImage()">ì‚­ì œ (Del)</button>
        <button id="save-btn" onclick="saveZIP()">ğŸ’¾ ZIPìœ¼ë¡œ ì €ì¥</button>
    </div>

    <!-- ìŠ¬ë¼ì´ë“œ ìŠ¤í…Œì´ì§€ (1280x720 ê³ ì • ë¹„ìœ¨) -->
    <div id="slide-stage">
        <!-- [1í˜ì´ì§€] -->
        <div class="slide active">
            <div class="guide-text">
                <h1>16:9 ê³ ì • ìº”ë²„ìŠ¤</h1>
                <p>ì´ì œ PPTì²˜ëŸ¼ ì‘ì—…í•˜ì„¸ìš”.</p>
                <p>ì´ í°ìƒ‰ ë°•ìŠ¤ê°€ <b>ìŠ¬ë¼ì´ë“œ ì˜ì—­</b>ì…ë‹ˆë‹¤.</p>
                <p>ì´ë¯¸ì§€ì™€ HTML íŒŒì¼ì„ ë“œë˜ê·¸í•˜ë©´ <b>ZIPìœ¼ë¡œ í•œ ë²ˆì— ì €ì¥</b>ë©ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <div id="page-indicator">1 / 1</div>

    <script>
        // === ì „ì—­ ë³€ìˆ˜ ===
        const STAGE_WIDTH = 1280;
        const STAGE_HEIGHT = 720;
        let currentScale = 1; // í˜„ì¬ í™”ë©´ ë°°ìœ¨

        let currentSlideIndex = 0;
        let slides = document.querySelectorAll('.slide'); 
        const indicator = document.getElementById('page-indicator');
        const saveBtn = document.getElementById('save-btn');
        let selectedImage = null;

        // [ì¶”ê°€] ZIP ì €ì¥ì„ ìœ„í•´ ì¶”ê°€ëœ HTML íŒŒì¼ë“¤ì„ ì„ì‹œ ë³´ê´€í•˜ëŠ” ì¥ì†Œ
        const embeddedFiles = new Map();

        // === ì´ˆê¸°í™” ë° ë°˜ì‘í˜• ìŠ¤ì¼€ì¼ë§ ===
        function resizeStage() {
            const stage = document.getElementById('slide-stage');
            
            // í™”ë©´ í¬ê¸° ëŒ€ë¹„ ìŠ¤í…Œì´ì§€ ë¹„ìœ¨ ê³„ì‚° (ì—¬ë°± 40px ì •ë„ í™•ë³´)
            const availableWidth = window.innerWidth - 40;
            const availableHeight = window.innerHeight - 40;

            const scaleX = availableWidth / STAGE_WIDTH;
            const scaleY = availableHeight / STAGE_HEIGHT;

            // ë” ì‘ì€ ë°°ìœ¨ì„ ë”°ë¼ê°€ì„œ í™”ë©´ì— ê½‰ ì°¨ê²Œ(Fit) ë§ì¶¤
            let scale = Math.min(scaleX, scaleY);
            
            // ë°œí‘œ ëª¨ë“œì¼ ë•ŒëŠ” ì—¬ë°± ì—†ì´ ê½‰ ì±„ì›€
            if (document.body.classList.contains('is-fullscreen')) {
                const fullScaleX = window.innerWidth / STAGE_WIDTH;
                const fullScaleY = window.innerHeight / STAGE_HEIGHT;
                scale = Math.min(fullScaleX, fullScaleY);
            }

            currentScale = scale;
            stage.style.transform = `scale(${scale})`;
        }

        window.addEventListener('resize', resizeStage);
        resizeStage(); // ì´ˆê¸° ì‹¤í–‰
        updateSlideVisibility();


        // === 1. ë„¤ë¹„ê²Œì´ì…˜ ===
        function updateSlideVisibility() {
            slides = document.querySelectorAll('.slide');
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                if (index === currentSlideIndex) slide.classList.add('active');
            });
            indicator.textContent = `${currentSlideIndex + 1} / ${slides.length}`;
            deselectImage();
        }

        function nextSlide() {
            if (currentSlideIndex < slides.length - 1) {
                currentSlideIndex++;
                updateSlideVisibility();
            }
        }

        function prevSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                updateSlideVisibility();
            }
        }

        function addNewSlide() {
            const stage = document.getElementById('slide-stage');
            const newSlide = document.createElement('div');
            newSlide.className = 'slide';
            const currentSlide = slides[currentSlideIndex];
            if (currentSlide.nextSibling) {
                stage.insertBefore(newSlide, currentSlide.nextSibling);
            } else {
                stage.appendChild(newSlide);
            }
            setTimeout(() => {
                slides = document.querySelectorAll('.slide');
                currentSlideIndex++; 
                updateSlideVisibility();
                showSaveButton();
            }, 50);
        }

        // === 2. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ===
        window.addEventListener('wheel', (e) => {
            if (e.deltaY > 0) nextSlide(); else prevSlide();
        });

        window.addEventListener('contextmenu', (e) => {
            e.preventDefault(); 
            if (document.body.classList.contains('is-fullscreen')) {
                if (currentSlideIndex === 0) return;
                prevSlide(); 
            } else {
                nextSlide();
            }
        });

        window.addEventListener('click', (e) => {
            if (!document.body.classList.contains('is-fullscreen')) return;
            if (e.target.closest('button') || e.target.closest('.nav-zone')) return;

            if (currentSlideIndex >= slides.length - 1) {
                exitPresentation();
                currentSlideIndex = 0;
                updateSlideVisibility();
            } else {
                nextSlide();
            }
        });

        window.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === 'ArrowDown' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') prevSlide();
            if (e.key === 'Delete' && selectedImage) deleteSelectedImage();
        });

        // === 3. ë“œë˜ê·¸ ì•¤ ë“œë¡­ (ìŠ¤í…Œì´ì§€ ìœ„ì—ì„œë§Œ) ===
        const stage = document.getElementById('slide-stage');

        window.addEventListener('dragover', (e) => { e.preventDefault(); e.stopPropagation(); stage.classList.add('drag-over'); });
        window.addEventListener('dragleave', (e) => { e.preventDefault(); e.stopPropagation(); if (e.target === stage || e.target === document.body) stage.classList.remove('drag-over'); });
        window.addEventListener('drop', (e) => {
            e.preventDefault(); e.stopPropagation(); stage.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length > 0) handleDroppedFiles(files);
        });

        function handleDroppedFiles(files) {
            for (const file of files) {
                if (file.type.includes('image')) {
                    const reader = new FileReader();
                    reader.onload = (event) => createDraggableImage(event.target.result);
                    reader.readAsDataURL(file);
                } else if (file.name.toLowerCase().endsWith('.html') || file.type === 'text/html') {
                    transformCurrentSlideToHtml(file);
                }
            }
        }

        function transformCurrentSlideToHtml(fileOrName) {
            const activeSlide = slides[currentSlideIndex];
            activeSlide.innerHTML = '';
            activeSlide.classList.add('iframe-slide');

            const container = document.createElement('div');
            container.className = 'iframe-container';

            const iframe = document.createElement('iframe');
            let displayName = "";
            
            if (fileOrName instanceof File) {
                iframe.src = URL.createObjectURL(fileOrName); 
                displayName = fileOrName.name;
                iframe.dataset.filename = fileOrName.name;
                // [í•µì‹¬] ZIP ì €ì¥ì„ ìœ„í•´ íŒŒì¼ ê°ì²´ë¥¼ ë©”ëª¨ë¦¬ì— ë³´ê´€
                embeddedFiles.set(fileOrName.name, fileOrName);
            } else {
                iframe.src = './' + fileOrName;
                displayName = fileOrName;
            }

            const notice = document.createElement('div');
            notice.className = 'iframe-notice';
            notice.innerHTML = `ğŸ“„ ${displayName}`;

            activeSlide.appendChild(container); // iframe ì»¨í…Œì´ë„ˆë¥¼ ìŠ¬ë¼ì´ë“œì— ê½‰ ì°¨ê²Œ
            container.appendChild(iframe);
            activeSlide.appendChild(notice); // ì•Œë¦¼ë°”ëŠ” ê·¸ ìœ„ì—
            
            showSaveButton();
        }

        // === 4. ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸° ===
        window.addEventListener('paste', (e) => {
            const items = (e.clipboardData || e.originalEvent.clipboardData).items;
            for (let item of items) {
                if (item.type.includes('image')) {
                    const blob = item.getAsFile();
                    const reader = new FileReader();
                    reader.onload = (event) => createDraggableImage(event.target.result);
                    reader.readAsDataURL(blob);
                }
            }
        });

        function createDraggableImage(src) {
            const activeSlide = slides[currentSlideIndex];
            
            const guideText = activeSlide.querySelector('.guide-text');
            if (guideText) guideText.remove();

            const wrapper = document.createElement('div');
            wrapper.className = 'draggable-img selected'; 
            // ì¤‘ì•™ì— ë°°ì¹˜ (1280x720 ê¸°ì¤€)
            wrapper.style.left = '400px'; 
            wrapper.style.top = '200px';
            wrapper.style.width = '480px'; 

            const img = document.createElement('img');
            img.src = src;
            img.style.width = '100%'; img.style.height = '100%';
            img.style.display = 'block'; img.ondragstart = () => false;
            
            const handle = document.createElement('div');
            handle.className = 'resize-handle';
            
            wrapper.appendChild(img); wrapper.appendChild(handle);
            activeSlide.appendChild(wrapper);
            
            setupInteraction(wrapper, handle);
            selectImage(wrapper);
            showSaveButton();
        }

        // === 5. ì¸í„°ë™ì…˜ (ìŠ¤ì¼€ì¼ ë³´ì • í•„ìˆ˜) ===
        function setupInteraction(element, handle) {
            element.addEventListener('mousedown', (e) => {
                if (document.body.classList.contains('is-fullscreen')) return;
                if (e.target === handle) return; 
                
                e.stopPropagation(); selectImage(element);
                
                const startX = e.clientX; 
                const startY = e.clientY;
                
                // í˜„ì¬ ìš”ì†Œì˜ left/top ê°’ (px)
                const startLeft = parseFloat(element.style.left || 0);
                const startTop = parseFloat(element.style.top || 0);

                function onMouseMove(e) {
                    // [ì¤‘ìš”] ë§ˆìš°ìŠ¤ ì´ë™ê±°ë¦¬ë¥¼ í˜„ì¬ ë°°ìœ¨(currentScale)ë¡œ ë‚˜ëˆ ì•¼
                    // ì‹¤ì œ 1280x720 ì¢Œí‘œê³„ì—ì„œì˜ ì´ë™ê±°ë¦¬ê°€ ë‚˜ì˜´
                    const dx = (e.clientX - startX) / currentScale;
                    const dy = (e.clientY - startY) / currentScale;

                    element.style.left = (startLeft + dx) + 'px';
                    element.style.top = (startTop + dy) + 'px';
                }
                function onMouseUp() {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                    showSaveButton();
                }
                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });

            handle.addEventListener('mousedown', (e) => {
                if (document.body.classList.contains('is-fullscreen')) return;

                e.stopPropagation(); e.preventDefault();
                const startX = e.clientX;
                const startWidth = parseFloat(getComputedStyle(element).width);
                const startHeight = parseFloat(getComputedStyle(element).height);
                const aspectRatio = startWidth / startHeight;

                function onMouseMove(e) {
                    // [ì¤‘ìš”] ë¦¬ì‚¬ì´ì¦ˆë„ ìŠ¤ì¼€ì¼ ë³´ì • í•„ìš”
                    const dx = (e.clientX - startX) / currentScale;
                    const newWidth = startWidth + dx;
                    
                    if (newWidth > 50) {
                        element.style.width = newWidth + 'px';
                        element.style.height = (newWidth / aspectRatio) + 'px';
                    }
                }
                function onMouseUp() {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                    showSaveButton();
                }
                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
        }

        // === 6. ìœ í‹¸ë¦¬í‹° & ì €ì¥ (ZIP ê¸°ëŠ¥ êµ¬í˜„) ===
        document.addEventListener('mousedown', (e) => {
            if (!e.target.closest('.draggable-img') && !e.target.closest('button') && !e.target.closest('.nav-zone')) deselectImage();
        });
        function selectImage(el) { deselectImage(); selectedImage = el; el.classList.add('selected'); }
        function deselectImage() { if (selectedImage) { selectedImage.classList.remove('selected'); selectedImage = null; } }
        function deleteSelectedImage() { if (selectedImage) { selectedImage.remove(); selectedImage = null; showSaveButton(); } }
        function showSaveButton() { saveBtn.style.display = 'block'; saveBtn.textContent = 'ğŸ’¾ ZIPìœ¼ë¡œ ì €ì¥'; }
        
        async function saveZIP() {
            deselectImage(); 
            
            if (typeof JSZip === 'undefined') {
                alert("ì••ì¶• ë¼ì´ë¸ŒëŸ¬ë¦¬(JSZip)ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                return;
            }

            const zip = new JSZip();

            // 1. ë©”ì¸ HTML íŒŒì¼ (presentation.html) ì¤€ë¹„
            const clone = document.documentElement.cloneNode(true);
            const iframes = clone.querySelectorAll('iframe');
            iframes.forEach(iframe => {
                if (iframe.dataset.filename) {
                    iframe.src = './' + iframe.dataset.filename;
                }
            });
            const guides = clone.querySelectorAll('.guide-text');
            guides.forEach(g => {
                if(g.parentElement.querySelector('.draggable-img') || g.parentElement.querySelector('iframe')) g.remove();
            });

            const htmlContent = clone.outerHTML;
            const date = new Date();
            const timeString = `${date.getHours()}ì‹œ${date.getMinutes()}ë¶„`;
            const mainFileName = `presentation_${timeString}.html`;
            
            // ë©”ì¸ íŒŒì¼ì„ ZIPì— ì¶”ê°€
            zip.file(mainFileName, htmlContent);

            // 2. ì¶”ê°€ëœ ì™¸ë¶€ HTML íŒŒì¼ë“¤ì„ ZIPì— ì¶”ê°€
            embeddedFiles.forEach((file, name) => {
                zip.file(name, file);
            });

            // 3. ZIP íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
            const content = await zip.generateAsync({type:"blob"});
            const zipFileName = `Presentation_Package_${timeString}.zip`;

            // ì €ì¥ ìœ„ì¹˜ ì„ íƒ (File System Access API)
            try {
                if (window.showSaveFilePicker) {
                    const handle = await window.showSaveFilePicker({
                        suggestedName: zipFileName,
                        types: [{ description: 'ZIP File', accept: { 'application/zip': ['.zip'] } }],
                    });
                    const writable = await handle.createWritable();
                    await writable.write(content);
                    await writable.close();
                    alert("ZIP íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\nì••ì¶•ì„ í’€ë©´ ëª¨ë“  íŒŒì¼ì´ ë“¤ì–´ìˆìŠµë‹ˆë‹¤.");
                    return; 
                }
            } catch (err) { console.log(err); }

            // Fallback: ê¸°ë³¸ ë‹¤ìš´ë¡œë“œ
            const link = document.createElement('a');
            link.href = URL.createObjectURL(content);
            link.download = zipFileName; 
            link.click();
            alert("ë‹¤ìš´ë¡œë“œ í´ë”ì— ZIP íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\nì••ì¶•ì„ í’€ê³  '" + mainFileName + "'ì„ ì‹¤í–‰í•˜ì„¸ìš”.");
        }

        // === 7. ì „ì²´í™”ë©´ ì œì–´ ===
        function startPresentation() {
            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen();
            else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
            else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
        }
        function exitPresentation() {
             if (document.exitFullscreen) document.exitFullscreen();
            else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
            else if (document.msExitFullscreen) document.msExitFullscreen();
        }

        // ì „ì²´í™”ë©´ ìƒíƒœ ë³€ê²½ ê°ì§€ -> ìŠ¤ì¼€ì¼ ì¬ì¡°ì •
        function handleFullscreenChange() {
            const isFs = document.fullscreenElement || document.webkitFullscreenElement;
            if (isFs) {
                document.body.classList.add('is-fullscreen');
            } else {
                document.body.classList.remove('is-fullscreen');
            }
            resizeStage(); // ìƒíƒœ ë³€ê²½ ì‹œ í¬ê¸° ì¬ê³„ì‚° (ì—¬ë°± ì œê±°/ë³µêµ¬)
        }
        
        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
        
        // F11 í‚¤ë³´ë“œ ê°ì§€ìš© (Fallback)
        window.addEventListener('resize', () => {
             resizeStage();
        });

    </script>
</body>
</html>